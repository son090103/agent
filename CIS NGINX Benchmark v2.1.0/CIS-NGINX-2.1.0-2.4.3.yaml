ruleId: CIS-NGINX-2.1.0-2.4.3
standard: "CIS NGINX Benchmark v2.1.0"
description: "Ensure keepalive_timeout is 10 seconds or less, but not 0."
severity: "Medium"
type: "config_check"
target:
  files:
    - "/etc/nginx/nginx.conf"
    - "/etc/nginx/conf.d/*.conf"
    - "/etc/nginx/sites-enabled/*.conf"
  directive: "keepalive_timeout"
assertion:
  condition: "value_in_range"
  value:
    min: 1
    max: 10
rationale: "Limiting the keepalive timeout reduces the risk of denial of service attacks that hold persistent connections open for extended periods, which can exhaust server resources."
remediation: |
  In your NGINX configuration (typically within the 'http' or 'server' block), set the keepalive_timeout directive to 10 seconds or less, but not 0. For example:
      keepalive_timeout 10;
