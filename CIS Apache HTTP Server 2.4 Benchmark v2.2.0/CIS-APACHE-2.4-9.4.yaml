ruleId: CIS-APACHE-2.4-9.4
standard: "CIS Apache HTTP Server 2.4 Benchmark v2.0.0"
description: "Ensure the KeepAliveTimeout directive is set to 15 seconds or less to improve server responsiveness and mitigate DoS risks."
severity: "Medium"
type: "config_check"
target:
  file: "apache2.conf"
  directive: "KeepAliveTimeout"
assertion:
  condition: "less_or_equal"
  value: 15
rationale: "A lower KeepAliveTimeout reduces the time idle connections are held open, freeing server resources more quickly. This improves performance and reduces the risk of Denial of Service (DoS) attacks caused by excessive idle connections."
remediation: |
  Perform the following steps to configure KeepAliveTimeout securely:

  1. Open the main Apache configuration file (e.g., /etc/apache2/apache2.conf or /etc/httpd/conf/httpd.conf).

  2. Locate or add the KeepAliveTimeout directive and set it to 15 or less:
         KeepAliveTimeout 15

     You may use a lower value (e.g., 5 to 10 seconds) depending on your server workload and latency.

  3. Save the file and verify the configuration syntax:
         $ sudo apachectl configtest
         Syntax OK

  4. Restart Apache to apply the configuration:
         $ sudo systemctl restart apache2

  5. Verify the applied setting:
         $ grep -R "KeepAliveTimeout" /etc/apache2/apache2.conf
     Expected output should show:
         KeepAliveTimeout 15
