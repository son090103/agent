ruleId: CIS-NGINX-2.1.0-5.2.1
standard: "CIS NGINX Benchmark v2.1.0"
description: "Ensure timeout values for reading the client header and body are set correctly."
severity: "Medium"
type: "config_check"
target:
  files:
    - "/etc/nginx/nginx.conf"
    - "/etc/nginx/conf.d/*.conf"
    - "/etc/nginx/sites-enabled/*.conf"
  directives:
    - "client_header_timeout"
    - "client_body_timeout"
assertion:
  condition: "value_in_range"
  value:
    min: 1
    max: 10
rationale: |
  Properly setting timeout values for reading client headers and bodies helps prevent
  slow HTTP denial of service (DoS) attacks. By limiting how long the server waits for data
  from a client, system resources are freed more quickly, improving overall resilience and performance.
remediation: |
  In your NGINX configuration (within the 'http' or 'server' block), set the following directives to 10 seconds or less:
      client_header_timeout 10;
      client_body_timeout 10;

  Example configuration:
      http {
          client_header_timeout 10;
          client_body_timeout 10;
      }
