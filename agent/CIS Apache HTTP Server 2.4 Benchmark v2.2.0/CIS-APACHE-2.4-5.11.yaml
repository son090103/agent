ruleId: CIS-APACHE-2.4-5.11
standard: "CIS Apache HTTP Server 2.4 Benchmark v2.0.0"
description: "Ensure access to .git directories is restricted using the DirectoryMatch directive."
severity: "High"
type: "config_check"
target:
  file: "apache2.conf"
  directive: "DirectoryMatch"
assertion:
  condition: "contains"
  value: '<DirectoryMatch "/\\.git">'
rationale: "Git repositories often contain sensitive configuration files, source code, and credentials. Exposing .git directories to the public may allow attackers to access application code and sensitive data. Restricting access prevents unauthorized disclosure."
remediation: |
  Perform the following steps to restrict access to .git directories:
  1. Open the main Apache configuration file (e.g., httpd.conf or apache2.conf).
  2. Add the following directive at the server-level configuration:
         <DirectoryMatch "/\.git">
             Require all denied
         </DirectoryMatch>
  3. Alternatively, you may use the legacy syntax:
         <DirectoryMatch "/\.git">
             Deny from all
         </DirectoryMatch>
  4. Save the configuration and restart Apache to apply the changes:
         $ sudo systemctl restart apache2
